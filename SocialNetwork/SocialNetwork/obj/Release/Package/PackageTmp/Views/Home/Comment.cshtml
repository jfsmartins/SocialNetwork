@model SocialNetwork.Models.Comentar

@*@using (Ajax.BeginForm("Comment_Count", new AjaxOptions()
{
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "nrcomentarios_" + @ViewBag.idPost,
}))*@

@using (Ajax.BeginForm("Comment", "Home", new AjaxOptions()
{
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "comentar_" + @ViewBag.idPost,
}, new { id = "comment-form_" + @ViewBag.idPost }))
{
@*@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "form_comentar" }))
{*@
    @*@using (Ajax.BeginForm("Comment", new AjaxOptions()
        {
            InsertionMode = InsertionMode.Replace,
            UpdateTargetId = "com"
        }))
        {*@

    @Html.AntiForgeryToken()
    <div class="row" id="com">
        <div class="col-md-7">

            <div class="form-horizontal">

                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                @*<script>
                  

                    $("#form_comentar").on('submit', (function (e) {

                        e.preventDefault();

                    }));


                </script>*@
                <div class="form-group">

                    <div class="col-md-12">
                        <br />
                        <div  style="padding-bottom:3px;">
                            @Html.EditorFor(model => model.texto, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.texto, "", new { @class = "text-danger" })
                        </div>
                        <input type="submit" id="comentarBotao"value="Comentar" class="btn btn-default" />
                    </div>
                </div>   
            </div>
        </div>
    </div>


<script>

    $(function () {

        $('#comment-form_@{@ViewBag.idPost}').on('submit', function (e) {
            //alert('cenas');
            //console.log(this.parent().parent().prev().children());
            $('#nrcomentarios_@{@ViewBag.idPost}').text(parseInt($('#nrcomentarios_@{@ViewBag.idPost}').text()) + 1)
        })


        $('#myelement_@{@ViewBag.idPost}').click(function (e) {
            //var id = $(this).data('assigned-id');
            e.preventDefault();
            //alert($('#another-element_@{@ViewBag.idPost}:visible').length);

            if ($('#another-element_@{@ViewBag.idPost}:visible').length) {
                $('#myelement_@{@ViewBag.idPost}').off();
                $('#another-element_@{@ViewBag.idPost}').hide();

            }
            else {

                $('#another-element_@{@ViewBag.idPost}').show();
                $('#myelement_@{@ViewBag.idPost}').off();
            }
        });

    });
</script>
}